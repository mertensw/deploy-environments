name: Deploy Pipeline 1

on:
  workflow_dispatch:
    inputs:
      skip_int:
        description: "Skip INT deployment"
        required: false
        default: "false"
      skip_acc:
        description: "Skip ACC deployment"
        required: false
        default: "false"
      skip_prd:
        description: "Skip PRD deployment"
        required: false
        default: "false"

jobs:
  # --- DEV ---
  deploy-dev:
    runs-on: ubuntu-latest
    environment: dev
    steps:
    - name: Deploy to DEV
      run: echo "Deploying to DEV"
    - name: Done marker
      if: always()
      run: echo "DEV complete (always runs)"

  # --- INT ---
  deploy-int:
    needs: deploy-dev
    runs-on: ubuntu-latest
    environment: int
    steps:
    - name: Maybe skip
      if: ${{ inputs.skip_int == 'true' }}
      run: echo "Skipping INT"
    - name: Deploy to INT
      if: ${{ inputs.skip_int != 'true' }}
      run: echo "Deploying to INT"
    - name: Done marker
      if: always()
      run: echo "INT complete (skipped or deployed)"

  # --- ACC ---
  deploy-acc:
    needs: deploy-int
    runs-on: ubuntu-latest
    environment: acc
    steps:
    - name: Maybe skip
      if: ${{ inputs.skip_acc == 'true' }}
      run: echo "Skipping ACC"
    - name: Deploy to ACC
      if: ${{ inputs.skip_acc != 'true' }}
      run: echo "Deploying to ACC"
    - name: Done marker
      if: always()
      run: echo "ACC complete (skipped or deployed)"

  # --- PRD ---
  deploy-prd:
    needs: deploy-acc
    runs-on: ubuntu-latest
    environment: prd
    steps:
    - name: Maybe skip
      if: ${{ inputs.skip_prd == 'true' }}
      run: echo "Skipping PRD"
    - name: Deploy to PRD
      if: ${{ inputs.skip_prd != 'true' }}
      run: echo "Deploying to PRD"
    - name: Done marker
      if: always()
      run: echo "PRD complete (skipped or deployed)"
